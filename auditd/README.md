# auditd

## Description

The audit package contains the user space utilities for storing and searching
the audit records generated by the audit subsystem in the Linux 2.6 kernel.

Examples: /usr/share/doc/auditd/examples/rules/

For more information on the usage and available configuration options,
consult the following sections.

## Usage

### Install

```
- hosts: all
  roles:
    - role: auditd
  vars:
    auditd_state: 'install'
```

### Enable

```
- hosts: all
  roles:
    - role: auditd
  vars:
    auditd_state: 'enable'
```

### Disable

```
- hosts: all
  roles:
    - role: auditd
  vars:
    auditd_state: 'disable'
```

### Remove

```
- hosts: all
  roles:
    - role: auditd
  vars:
    auditd_state: 'remove'
```

### Inactive

```
- hosts: all
  roles:
    - role: auditd
  vars:
    auditd_state: 'inactive'
```

### Config

```
vars:
  auditd_config_all:
    - name: 'audit'
      state: True
      config: |
        # First rule - delete all
        -D
        # Increase the buffers to survive stress events.
        -b 8192
        # Set the time for the kernel to wait
        --backlog_wait_time 60000
        # Set failure mode to syslog
        -f 1
        # Watch '/etc/shadow' for changes
        -w /etc/shadow -p wa
        # Recursively watch '/etc/' for changes
        -w /etc/ -p wa
        # Log all syscalls made by a specific program
        -a exit,always -S all -F pid=1337

  auditd_config_group:
    - name: 'audit'
      state: True
      config: |
        # First rule - delete all
        -D
        # Increase the buffers to survive stress events.
        -b 8192
        # Set the time for the kernel to wait
        --backlog_wait_time 60000
        # Set failure mode to syslog
        -f 1
        # Log all commands (32-bit)
        -a exit,always -F arch=b32 -S execve -k auditcmd
        # Log all commands (64-bit)
        -a exit,always -F arch=b64 -S execve -k auditcmd
        # Enable auditd
        -e 1
        # Make config immutable - reboot required to change ruleset
        -e 2

  auditd_config_host:
    - name: 'home'
      state: True
      config: |
        # Log if an admin is accessing files of other users
        -a exit,always -F dir=/home/ -F uid=0 -C auid!=obj_uid
```

## Parameters

### Role

`auditd_state`

    Description: Control the state of the role.
    Implemented: 0.1.0
    Required   : False
    Value      : Predetermined
    Type       : String
    Default    : 'enable'
    Options    :
      Install : 'true' | 'yes' | 'install'
      Enable  : 'start' | 'on' | 'enable'
      Disable : 'stop' | 'off' | 'disable'
      Remove  : 'false' | 'no' | 'remove'
      Inactive: 'quiesce' | 'inactive'

`auditd_config_all:`

    Description: Define the 'auditd_config_all' option.
    Implemented: 0.1.0
    Required   : False
    Value      : Arbitrary
    Type       : Array/Hash
    Default    : - state: True
                   name: 'audit'
                   config: |
                     # First rule - delete all
                     -D
                     # Increase the buffers to survive stress events.
                     -b 8192
                     # Set the time for the kernel to wait
                     --backlog_wait_time 60000
                     # Set failure mode to syslog
                     -f 1
    Options    :
      Examples: - state: True
                  name: 'file'
                  config: |
                    # Watch '/etc/shadow' for changes
                    -w /etc/shadow -p wa
      None    : []

`auditd_config_group`

    Description: Define the 'auditd_config_group' option.
    Implemented: 0.1.0
    Required   : False
    Value      : Arbitrary
    Type       : Array/Hash
    Default    : []
    Options    :
      Examples: - state: True
                  name: 'file'
                  config: |
                    # Watch '/etc/shadow' for changes
                    -w /etc/shadow -p wa
      None    : []

`auditd_config_host`

    Description: Define the 'auditd_config_host' option.
    Implemented: 0.1.0
    Required   : False
    Value      : Arbitrary
    Type       : Array/Hash
    Default    : []
    Options    :
      Examples: - state: True
                  name: 'file'
                  config: |
                    # Watch '/etc/shadow' for changes
                    -w /etc/shadow -p wa
      None    : []

`auditd_monitor_monit_state`

    Description: Control the 'auditd_monitor_monit_state' option.
    Implemented: 0.1.0
    Required   : False
    Value      : Predetermined
    Type       : Boolean
    Default    : False
    Options    : True | False

`auditd_syslog_active`

    Description: Control the 'auditd_syslog_active' option.
    Implemented: 0.1.0
    Required   : False
    Value      : Predetermined
    Type       : Boolean
    Default    : True
    Options    : True | False

## Conflicts

## Dependencies

### Packages

`audit`

    Version: >= 2.0
    Name   :
      Debian 11: 'auditd'
      Debian 12: 'auditd'

`audispd_plugins`

    Version: >= 2.0
    Name   :
      Debian 11: 'audispd-plugins'
      Debian 12: 'audispd-plugins'

## Parameters

## Requirements

### Control Node

`ansible`

    Version: >= 2.8.0

### Managed Node

`python`

    Version: >= 2.7.0

## Support

### Operating Systems

`debian`

    Version: 11
    Version: 12
